;
;  XETTER '91
;     for MZ-1500
;
; Nov. 10, 1991
;     by K.Kuromusha    No.19
;
 OFFSET $0500
 START  $3000
;
;Object É $3500~
;
GAMEN EQU GAMN+41
GET   EQU $001B
MUS   EQU $0030
BELL  EQU $003E
BRKEY EQU $001E
?DPCT EQU $0DDC
;
 GOTO START
;
GC    [HL [BC [AF
 PORT($E3)=A
 HL=$D4A1 A=0
 DO C=20
 DO B=38
 (HL+)=A
 UNTIL DEC(B)=0
 HL++
 UNTIL DEC(C)=0
 ]AF ]BC ]HL
 RET
;
VC    [DE [HL [BC
 PORT($E3)=A
 HL=$D400 DE=$D401 BC=999
 (HL)=" "
 LDIR
 ]BC ]HL ]DE
 RET
;
SHOKI A=3 PORT($F0)=A A=0
 DO B=8
 PORT($F1)=A A=A+$11
 UNTIL DEC(B)=0
 PORT($E3)=A
 HL=$D000 DE=$D001 BC=999
 (HL)=0 LDIR
 HL=$D800 DE=$D801 BC=999
 (HL)=0 LDIR
 HL=$DC00 DE=$DC01 BC=999
 (HL)=8 LDIR
 !PCG
 !VC
 DO HL=$1000
 PORT($E2)=A A=(-HL)
 PORT($E0)=A (HL)=A
 UNTIL HL=0
 HL=$02D1 A=(HL) IF A<>$20 GOTO TEMP
 (HL)=$18
TEMP  PORT($E3)=A
 A=7 !$0041  ;TEMPO
 A=0 !PSOUT
 A=$E0 PORT($F2)=A PORT($F3)=A
 RET
;
MELDY PORT($E0)=A
 !MUS
 PORT($E3)=A
 RET
;
PCG   HL=PCG1
 DO A=1
 PORT($E5)=A AF<>AF'
 DE=$D400
 DO B=240
 A=(HL+) (DE+)=A
 UNTIL DEC(B)=0
 DE=$D700
 DO B=112
 A=(HL+) (DE+)=A
 UNTIL DEC(B)=0
 AF<>AF' A+
 UNTIL A=4
 A=$2F (PCGS0)=A  ;CPL
 HL=$D100 DE=$D780
 B=80 !PCGS       ;~˘
 A=0 (PCGS0)=A
 HL=$D008 DE=$D208
 B=208 !PCGS      ;A~Z
 HL=$D808 DE=$D308
 B=208 !PCGS      ;a~z
 HL=$D100 DE=$D180
 B=80 !PCGS       ;0~9
 HL=$D308 DE=$D108
 B=72 !PCGS       ;!~)
 HL=$D000 DE=$D100
 B=8 !PCGS        ;" "
 HL=PCGT
PCG0  C=(HL+) B=(HL+)
 IF C=0 GOTO PCG01
 [HL HL=$D008 DE=HL
 DO A=0
 A=A+L IF CY THEN H+
 UNTIL DEC(B)=0
 L=A
 DO A=0
 A=A+E IF CY THEN D+
 UNTIL DEC(C)=0
 E=A B=8
 !PCGS ]HL
 GOTO PCG0
PCG01 DE=$D508
 DO C=63
 B=(HL+) [HL HL=$D008
 DO A=0
 A=A+L IF CY THEN H+
 UNTIL DEC(B)=0
 L=A B=8
 !PCGS ]HL
 UNTIL DEC(C)=0
 PORT($E6)=A
 RET
;
PCGS  DO
 A=0 PORT($E5)=A
 A=(HL+)
PCGS0 NOP AF<>AF'
 DO A=3
 PORT($E5)=A
 AF<>AF' (DE)=A AF<>AF'
 UNTIL DEC(A)=0
 DE+
 UNTIL DEC(B)=0
 RET
;
PCG1  !(0000F70000007F00183C7EFFFF7E3C1800000102043C021C00008040203C4038)
 !(361C0000000000006C3800000000000000000001070F1B3300000080E0F0D8CC)
 !(3F7F7F7F06467E3CFCFEFEFE60627E3C00000000000000000000000000000000)
 !(000000000010387C0000000000081C3E00000000000000000000000000000000)
 !(00000000001C3C7C0000000000383C3E00000000000000000000000000000000)
 !(00000000607C3C0C00000000000E1E3E00000000000000000000000000000000)
 !(000000000070787C00000000063E3C3000000000000000000000000000000000)
 !(00000000F07C3C0C000000000F3E3C30)
PCG11 !(00000000001C3C7C00000000060E3C700000000060703C0E0000000000383C3E)
 !(00003F3F3F3F3F3F0000FCFCFCFCFCFC3F3F3F3F3F3F0000FCFCFCFCFCFC0000)
 !(0000000000001C7E000000000000387E000078001E00000000001E0078000000)
 !(0103070F19BFFE7E80C0E0F098FD7F7E)
PCG2  !(F7F700007F7F00000000001818000000000042657B437D63000042A6DEC2BEC6)
 !(55637F3E06467E3CAAC6FE7C60627E3C0000000000060A120000000000605048)
 !(1E00000000000000780000000000000000000000000060600000000000000606)
 !(4040404000000000020202020000000000000000000060600000000000000606)
 !(6040404000000000060202020000000000000000000000000000000000606060)
 !(0000000000000000202020000000000000000000000606060000000000000000)
 !(0404040000000000000000000000000000204040404060600004020202020606)
 !(20000000000000000400000000000000)
PCG20 !(0000000000000000204080000000000004020100000000000000000000000000)
 !(3F7FFFE0E0E0E0E0FCFEFF0767171707E0E0E0E0E0FF7F3F0707070707FFFEFC)
 !(0000008080800000000000010101000083FF877F79BFFE7EC1FFE1FE9EFD7F7E)
 !(00000002080200000000004010400000)
PCG3  !(00F7F700007F7F0000183C7E7E3C1800000043667C7C7E630000C2663E3E7EC6)
 !(55637F3E06467E3CAAC6FE7C60627E3C00001821472F1B3300001884E2F4D8CC)
 !(3F7E7C7F06467E3CFC7E3EFE60627E3C00030F1F1F3F1F1F00C0F0F8F8FCF8F8)
 !(3F3F3F3F1F1F3F7CFCFCFCFCF8F8FC3E00030F1F1F3B1B1F00C0F0F8F8DCD8F8)
 !(1F3F3F3F1F1F3F7CF8FCFCFCF8F8FC3E00030F1F1F3B3B3F00E0F8F8FC9C9E9E)
 !(3F3F1F0F7F7F3F0CDEDEDCFCF8FE9E3E00071F1F3F39797900C0F0F8F8DCDCFC)
 !(7B7B3B3F1F7F797CFCFCF8F0FEFEFC30000000030F1F151B000000C0F0F8A8D8)
 !(153F3F3EFD7F3F0FA8FCFC7CBFFEFCF0)
PCG30 !(3F3F1F1F0F1F3F7CDEBE7CFCFEFE3C707B7D3E3F7F7F3C0EFCFCF8F8F0F8FC3E)
 !(3F7FC0C0C0C0C0C0FCFE030363131303C0C0C0C0C0C07F3F030303030303FEFC)
 !(071F2B776B7F3F7EE0F8D4EED6FEFC7E82FEFC7F79BFFE7E417F3FFE9EFD7F7E)
 !(0173477F19BFFE7E80CEE2FE98FD7F7E)
;
PCGT  !("CÔ[R]T*k+j,/-*../-:O;,<Q=+>W?I@U"0000)
 !(BD9DB1B5B9B49EB2B6BABE9FB3B7BBBFA385A4A5A69487889C82988492908391)
 !(819A97939589A1AF8B8696A2ABAA8A8EB0AD8DA7A8A98F8CAEAC9BA099BCB8)
;
LOCX  DEFS 1
LOCY  DEFS 1
;
PRNT  [AF [BC [HL
 PORT($E3)=A
 H=$D4 A=(LOCX) L=A
 A=(LOCY) IF A=0 GOTO PRNT0
 B=A A=L
 DO L=40
 A=A+L IF CY THEN H+
 UNTIL DEC(B)=0
 L=A
PRNT0 A=(DE+)
 IF A>="" THEN (HL+)=A GOTO PRNT0
 IF A=5 THEN HL=$D400 GOTO PRNT0
 IF A=3 THEN HL+ GOTO PRNT0
 IF A=4 THEN HL- GOTO PRNT0
 BC=40
 IF A=1 THEN HL=HL+BC GOTO PRNT0
 IF A=2 THEN HL=HL-.BC GOTO PRNT0
 A=H H=$D4 A=A-H H=A
 DO A=$FF
 A+ HL=HL-.BC
 UNTIL CY
 HL=HL+BC (LOCY)=A
 A=L (LOCX)=A
 ]HL ]BC ]AF
 RET
;
 DEFS 80
;
START SP=START
 !SHOKI
L0    !DEMO
L1    A=(MEN)
 IF A=31 THEN A=1 (MEN)=A
 !S3
LOOP  !IMOVE
 !SSC
 A=(BOM)
 IF A=1 THEN A=0 !PSOUT GOTO BOMY
 A=(CLR)
 IF A=0 THEN !PSOUT GOTO CLR1
 !EMOVE
 A=(BOM)
 IF A=1 THEN A=0 !PSOUT GOTO BOMY0
 !YMOVE
 HL=(TIME)
 HL-
 (TIME)=HL
 !SSC
 A=(BOM)
 IF A=1 THEN A=0 !PSOUT GOTO BOMY
 HL=(TIME)
 IF HL=0 THEN A=0 !PSOUT GOTO BOMY
 GOTO LOOP
;
SC    DEFS 2
HI    DEFS 2
BOM   DEFS 1
CLR   DEFS 1
MEN   DEFS 1
MY    DEFS 1
ED    DEFS 1
;
DEM0  !("")
 !("              ")
 !("                                ")
 !("                         ")
 !("                                ")
 !("                    "0D)
DEM1  !("     "0D)
 !("      "0D)
 !("      "0D)
 !("         "0D)
 !("      "0D)
 !("            "0D)
;
DE0   !("")
 !("       Programmed by K.Kuromusha        ")
 !("     Push 1 or 2 or 3 key.              ")
 !("               1. GAME START            ")
 !("               2. SCENE SELECT          ")
 !("               3. CONSTRUCTION MODE"0D)
;
WAIT  [BC
 DO B=229
 DO C=0
 UNTIL DEC(C)=0
 UNTIL DEC(B)=0
 ]BC RET
;
SCL   [BC
 HL=$D543
 DE=$D542
 BC=$00C8
 LDIR
 ]BC
 RET
;
SCR   [BC
 HL=$D7BC
 DE=$D7BD
 BC=$00C8
 LDDR
 ]BC
 RET
;
SCU3  [BC
 HL=$D568
 DE=$D540
 BC=$0280
 LDIR
 ]BC
 RET
;
SCU2  [BC
 HL=$D478
 DE=$D450
 BC=$02F8
 LDIR
 ]BC
 RET
;
SCU1  [BC [DE
 HL=$D6A8
 DE=$D680
 BC=$0140
 LDIR
 ]DE ]BC
 RET
;
SCD   [BC
 HL=$D797
 DE=$D7BF
 BC=$0280
 LDDR
 ]BC
 RET
;
WAIT0 [BC
 DO B=229
 UNTIL DEC(B)=0
 ]BC RET
;
DEMO  !VC
 HL=0 (SC)=HL
 A=0 (ED)=A
 A+ (MEN)=A
 A=5 (MY)=A
 DE=DEM0 !PRNT
 DO B=4
 !WAIT
 UNTIL DEC(B)=0
 DE=DEM1
 DO B=6
 HL=$180F (LOCX)=HL
 !SCU1 !PRNT !WAIT0
 UNTIL DEC(B)=0
 DO B=3
 !SCU1 !WAIT0
 UNTIL DEC(B)=0
 DO B=8
 !SCU2 !WAIT0
 UNTIL DEC(B)=0
 DO B=13
 !SCL !WAIT0
 UNTIL DEC(B)=0
 DO B=11
 !SCD !WAIT0
 UNTIL DEC(B)=0
 DO B=24
 !SCR !WAIT0
 UNTIL DEC(B)=0
 DO B=11
 !SCU3 !WAIT0 !WAIT0
 UNTIL DEC(B)=0
 DE=DE0 !PRNT
KDEMO A="Ò" ($D702)=A
 A="3" ($D70C)=A
 !KD
 A="1" ($D702)=A
 A="Ú" ($D707)=A
 !KD
 A="2" ($D707)=A
 A="Û" ($D70C)=A
 !KD GOTO KDEMO
;
KD    ]HL
 DO B=120
 !GETKY
 IF A="1" RET
 IF A="2" GOTO SELCT
 IF A="3" GOTO EDIT
 UNTIL DEC(B)=0
 [HL RET
;
GETD  DEFS 1
;
GETKY [HL [DE
 HL=GETD D=(HL)
 !GETK
 IF A=D THEN A=0 GOTO GETK0
 (HL)=A
GETK0 ]DE ]HL
 RET
;
GETK  A=$C9 !?DPCT
 !GET
 RET
;
SELCT !VC DE=SLCTA
SLCTT !PRNT HL=END-190 DE=190 EXX
 DO C=5
 DO B=6
 [BC A=7 A=A-B B=A
 A=6 A=A-C C=A
 !SLCTC A=0 !SLCTP ]BC
 EXX HL=HL+DE A=(HL) EXX
 IF A="6" THEN !PRNT
 UNTIL DEC(B)=0
 UNTIL DEC(C)=0
 BC=$101
SLCT1 !SLCTC A=1 !SLCTP
SLCT2 !GETKY
 IF A=" " GOTO SLCT3
 IF A=$11 THEN !SLCTD C+ GOTO SLCT4
 IF A=$12 THEN !SLCTD C- GOTO SLCT4
 IF A=$13 THEN !SLCTD B+ GOTO SLCT4
 IF A=$14 THEN !SLCTD B- GOTO SLCT4
 IF A="a" GOTO SLCT5
 IF A="d" GOTO SLCT7
 GOTO SLCT2
SLCT7 A=(ED) IF A=0 GOTO DEMO
 CY=1 RET
SLCT3 [BC !SLCTM ]BC (MEN)=A
 A=(ED) IF A=0 RET
 HL=END-190 DE=190
 DO A=(MEN)
 HL=HL+DE
 UNTIL DEC(A)=0
 A=(HL) IF A="6" RET
 GOTO SLCT2
SLCT4 IF B=0 THEN B=6
 IF C=0 THEN C=5
 A=7 IF A=B THEN B=1
 A=6 IF A=C THEN C=1
 GOTO SLCT1
SLCT5 !SLCTD
 HL=END DE=190
 DO B=30
 A=(HL) HL=HL+DE
 IF A<>"6" GOTO SLCT6
 UNTIL DEC(B)=0
 BC=$101 GOTO SLCT1
SLCT6 A=30 A=A-B C=0
 DO L=6
 C+ A=A-L
 UNTIL CY
 A=A+L B=A B+
 GOTO SLCT1
;
SLCTD !SLCTC A=0 !SLCTP RET
;
SLCTC [BC [HL A=$FD
 DO L=6
 A=A+L
 UNTIL DEC(B)=0
 (LOCX)=A A=3
 DO L=3
 A=A+L
 UNTIL DEC(C)=0
 (LOCY)=A ]HL ]BC
 RET
;
SLCTP [HL [BC AF<>AF'
 DE=SLCT0 !SLCTM
 B=$FF
 DO L=10
 B+ A=A-L
 UNTIL CY
 A=A+L C=A AF<>AF' IF A=0 GOTO SLCTR
 A="" A=A+B IF B=0 THEN A=""
 (DE+)=A A=""
SLCTS A=A+C (DE-)=A !PRNT
 ]BC ]HL
 RET
;
SLCTM A=B
 B=C B- IF Z RET
 DO C=6
 A=A+C
 UNTIL DEC(B)=0
 RET
;
SLCTR A="0" A=A+B IF B=0 THEN A=" "
 (DE+)=A A="0"
 GOTO SLCTS
;
SLCTA !("           ≈›“› ∂◊  ºﬁ“œΩ∂ ?"0D)
EDITD !("          ≈›“› ¶ ¥√ﬁ®Øƒ ºœΩ∂ ?"0D)
SLCT0 !("  "0D)
 !("*"0D)
;
PUT   [HL [DE [BC [AF
 A=(GX) C=A
 A=(GY) B=A
 HL=GAMEN-40
 D=0 E=C
 HL=HL+DE DE=40
 DO B+
 HL=HL+DE
 UNTIL DEC(B)=0
 A=(GZ)
 IF A>=6 THEN A=6
 (HL+)=A (HL)=A
 DE- HL=HL+DE
 (HL+)=A (HL)=A
 A=(GY) A=A+4 B=A
 C+ (LOCX)=BC
 HL=GC0-8 A=(GZ) B=A B+
 DO DE=8
 HL=HL+DE
 UNTIL DEC(B)=0
 IF A<8 GOTO GGG
 IF A=10 GOTO GGG
 A=(MA) IF A=0 GOTO GGG
 DE=24 HL=HL+DE
GGG   HL<>DE !PRNT
 ]AF ]BC ]DE ]HL
 RET
;
GX    DEFS 1
GY    DEFS 1
GZ    DEFS 1
;
GAMN  !("")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("                                      ")
 !("")
;
GC0   !("    "0D)
GC1   !("ÇÉÑÖ"0D)
GC2   !("Üáàâ"0D)
GC3   !("‰ÂÊÁ"0D)
GC4   !("ÅÅÅÅ"0D)
GC5   !("ÄÄÄÄ"0D)
GC6   !("äãåç"0D)
GC7   !("éèêë"0D)
GC8   !("íìîï"0D)
GC9   !("ñóòô"0D)
GCBOM !("öõúù"0D)
GC8][ !("íì‡·"0D)
GC9][ !("ñó‚„"0D)
;
GC10  !("ËÈ"0D)
GC11  !("ÍÎ"0D)
GC12  !("ÏÌ"0D)
GC00  !("  "0D)
;
SPUT  [HL [DE [BC [AF
 A=(GX) C=A
 A=(GY) B=A
 HL=GAMEN-40
 D=0 E=C
 HL=HL+DE DE=40
 DO B+
 HL=HL+DE
 UNTIL DEC(B)=0
 A=(GZ)
 (HL+)=A (HL)=A
 A=(GY) A=A+4 B=A
 C+ (LOCX)=BC
 A=(GZ)
 DE=GC00
 IF A=10 THEN DE=GC10
 IF A=11 THEN DE=GC11
 IF A=12 THEN DE=GC12
 !PRNT
 ]AF ]BC ]DE ]HL
 RET
;
WALL  [BC [DE [HL [AF
 PORT($E3)=A A="Ä"
 HL=$D401
 DO B=38
 (HL+)=A
 UNTIL DEC(B)=0
 HL=$D479
 DO B=38
 (HL+)=A
 UNTIL DEC(B)=0
 HL=$D7C1
 DO B=38
 (HL+)=A
 UNTIL DEC(B)=0
 HL=$D400 DE=40
 DO B=25
 (HL)=A
 HL=HL+DE
 UNTIL DEC(B)=0
 HL=$D427
 DO B=25
 (HL)=A
 HL=HL+DE
 UNTIL DEC(B)=0
 HL=$D439 (HL)=A
 HL=HL+DE (HL)=A
 HL=$D443 (HL)=A
 HL=HL+DE (HL)=A
 ]AF ]HL ]DE ]BC
 RET
;
MYX   DEFS 1
MYY   DEFS 1
;
T11   DEFS 3
T12   DEFS 3
T13   DEFS 3
T14   DEFS 3
T21   DEFS 3
T22   DEFS 3
T23   DEFS 3
T24   DEFS 3
;
IWA1  DEFS 3
IWA2  DEFS 3
IWA3  DEFS 3
IWA4  DEFS 3
IWA5  DEFS 3
IWA6  DEFS 3
IWA7  DEFS 3
IWA8  DEFS 3
IWA9  DEFS 3
IWA10 DEFS 3
IWA11 DEFS 3
IWA12 DEFS 3
IWA13 DEFS 3
IWA14 DEFS 3
IWA15 DEFS 3
;
TIME  DEFS 2
CONST DEFS 1
MA    DEFS 1
;
S3    !VC
 A=0
 (MA)=A
 (BOM)=A
 (CLR)=A
 (MYX)=A
 (MYY)=A
 (PPSS)=A
 HL=PSD1 (PSDS1)=HL
 HL=PSD2 (PSDS2)=HL
 HL=PSD3 (PSDS3)=HL
 HL=PSD4 (PSDS4)=HL
 HL=PSD5 (PSDS5)=HL
 HL=PSD6 (PSDS6)=HL
 HL=1500
 (TIME)=HL
 HL=T11
 (HL)=0
 DE=T11+1
 BC=68
 LDIR
 HL=END-190
 A=(MEN)
 DO DE=190
 HL=HL+DE
 UNTIL DEC(A)=0
 !WALL
 E=0
S3S1  D=0
S3S2  A=(HL)
 [HL
 !TOROK
 ]HL
 (GZ)=A
 A=D (GX)=A
 A=E (GY)=A
 !PUT
 HL+
 D++
 A=38
 IF A<>D GOTO S3S2
 E++
 A=20
 IF A<>E GOTO S3S1
 DE=S3D1 !PRNT
 DE=S3D2 !PRNT
 HL=$11C (LOCX)=HL
 A=(MY)
S3S3  IF DEC(A)=0 GOTO S3S4
 DE=GC7 !PRNT
 DE=GUP !PRNT
 GOTO S3S3
S3S4  !SSC A=(ED) IF A<>0 RET
 DO B=3
 !WAIT
 UNTIL DEC(B)=0
 DE=music !MELDY
 RET
;
music !("R1"0D)
GUP   !(""0D)
;
TOROK [AF IF DE=0 GOTO TRK0
 ]AF IF A=" " THEN A=0 RET
 IF A="5" THEN A=5 RET
 IF A="4" GOTO TR4
 IF A="3" GOTO TR3
 IF A="2" GOTO TR2
 IF A="1" GOTO TR1
 (HL)=" " A=0 RET
;
TRK0  ]AF
 IF A="7" GOTO TRK00
 IF A="6" GOTO TRK00
 (HL)="6"
TRK00 A=9
 RET
;
TR1   HL=T11+2 B=0
TR1S  A=4 IF A=B THEN ]BC ]HL [HL [BC (HL)=" " A=0 RET
 A=(HL) B+
 IF A<>0 THEN HL++ HL+ GOTO TR1S
 (HL)=1 HL-
 (HL)=E HL-
 (HL)=D
 A=1 RET
;
TR2   HL=T21+2 B=0
TR2S  A=4 IF A=B THEN ]BC ]HL [HL [BC (HL)=" " A=0 RET
 A=(HL) B+
 IF A<>0 THEN HL++ HL+ GOTO TR2S
 (HL)=1 HL-
 (HL)=E HL-
 (HL)=D
 A=2 RET
;
TR3   HL=IWA1+2 B=0
TR3S  A=15 IF A=B THEN ]BC ]HL [HL [BC (HL)=" " A=0 RET
 A=(HL) B+
 IF A<>0 THEN HL++ HL+ GOTO TR3S
 (HL)=1 HL-
 (HL)=E HL-
 (HL)=D
 A=3 RET
;
TR4   A=(CLR)
 IF A=252 THEN (HL)=" " A=0 RET
 A=A+4 (CLR)=A
 A=4 RET
;
S3D1  !("HI-SCORE        SCENE"0D)
S3D2  !("SCORE        TIME"0D)
;
SSCD1 !("     0"0D)
;
SSC   [BC [DE [HL [AF
 HL=(SC) [HL
 DE<>HL
 HL=(HI) CY=0
 HL=HL-DE
 IF CY THEN ]HL [HL (HI)=HL
 ]HL
 !SSCS
 HL=LOCX
 (HL)=11 HL+ (HL)=2
 DE=SSCD1 !SCS
 !PRNT
 HL=(HI)
 !SSCS
 HL=LOCX
 (HL)=11 HL+ (HL)=1
 DE=SSCD1 !SCS
 !PRNT
 HL=(TIME)
 !SSCS
 HL=LOCX
 (HL)=23 HL+ (HL)=2
 DE=SSCD1+1 !SCS0
 HL=SSCD1+5
 (HL)=$0D
 !PRNT
 HL=(MEN)
 H=0
 !SSCS
 HL=LOCX
 (HL)=24 HL+ (HL)=1
 DE=SSCD1+2 !SCS
 HL=SSCD1+5
 !PRNT
 (HL)="0"
 ]AF ]HL ]DE ]BC
 RET
;
SSCS  CY=0
 DE=10000 C=0 B=$30
SSCS1 HL=HL-DE
 IF NC THEN C+ GOTO SSCS1
 HL=HL+DE A=C A=A+B
 (SSCD1)=A
 DE=1000 C=0
SSCS2 HL=HL-DE
 IF NC THEN C+ GOTO SSCS2
 HL=HL+DE A=C A=A+B
 (SSCD1+1)=A
 DE=100 C=0
SSCS3 HL=HL-DE
 IF NC THEN C+ GOTO SSCS3
 HL=HL+DE A=C A=A+B
 (SSCD1+2)=A
 DE=10 C=0
SSCS4 HL=HL-DE
 IF NC THEN C+ GOTO SSCS4
 HL=HL+DE A=C A=A+B
 (SSCD1+3)=A
 A=L A=A+B
 (SSCD1+4)=A
 RET
;
SCS   [AF [HL [BC
 HL=SSCD1
 DO B=5
 A=(HL)
 IF A<>"0" GOTO SCSS
 A=" "
 (HL+)=A
 UNTIL DEC(B)=0
SCSS  ]BC ]HL ]AF
 RET
;
SCS0  [AF [HL [BC
 HL=SSCD1+1
 DO B=3
 A=(HL)
 IF A<>"0" GOTO SCSS
 A=" "
 (HL+)=A
 UNTIL DEC(B)=0
 GOTO SCSS
;
MS3   !("B2AGBDGBAFBBAGBDGBAFBBAGBDGBAFB9"0D)
;
BOMY0 HL=(TIME)
 IF DEC(HL)=0 THEN DE=MS5 !MELDY GOTO L1
 DE=MS1 !MELDY
 A=(MY) A-
 (MY)=A
 IF A<>0 GOTO L1
 DE=MS2
 !MELDY
 !GC
 DE=BOMYD
 !PRNT
 DO B=8
 !WAIT
 UNTIL DEC(B)=0
 GOTO L0
;
BOMY  A=10 (GZ)=A
 A=(MYX) (GX)=A
 A=(MYY) (GY)=A
 !PUT GOTO BOMY0
;
MS1   !("-C0-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C-D-C"0D)
MS2   !("R9+B2+A+G+F+E+D+CBAGEDC-B-A-G-F-E-D-C-D-E-F-G-A-BR-C9"0D)
BOMYD !("              GAME OVER"0D)
;
CLR1  DE=(TIME) HL=0 BC=10
 DO A=16 HL<>DE HL=HL+HL DE<>HL
 HL=HL+.HL E+ HL=HL-.BC
 IF CY THEN HL=HL+BC E-
 UNTIL DEC(A)=0
 HL=(SC) HL=HL+DE (SC)=HL
 !SSC !WAIT
 DE=MS3
 !MELDY
 A=(MEN) A+
 (MEN)=A !KEYP
 HL=(TIME) HL=HL-80
 IF HL=0 GOSUB CLR7
 !WAIT
 GOTO L1
;
CLR7  A=(MY) IF A=6 RET
 A+ (MY)=A DE=MS7
 !MELDY RET
;
MS5   !("R9C5EGECEG+CDFA+D+C3BAGAB+C9"0D)
MS7   !("R9G2GFEDGGFEDGGFEDGGABBGBGBGGABAFAFAFEDC9D0EFGAB+C"0D)
;
KEYP  B=A HL=END-190 DE=190
 DO B-
 HL=HL+DE
 UNTIL DEC(B)=0
 A=(HL) IF A="6" RET
 A="6" (HL)=A HL=END C=0
 DO B=30
 A=(HL) IF A="6" THEN C+
 HL=HL+DE
 UNTIL DEC(B)=0
 A=30 IF A<>C RET
 DO B=3 !WAIT UNTIL DEC(B)=0
 ]HL !VC A=0
 DE=CRD1 !PRNT (LOCX)=A
 !PRNT (LOCX)=A
 !PRNT (LOCX)=A
 !PRNT (LOCX)=A
 !PRNT (LOCX)=A
 DO B=3
 DE=MS3 !MELDY
 UNTIL DEC(B)=0
 !WAIT
 DE=CRD6 !PRNT
CRK   !GETKY
 IF A<>" " GOTO CRK
 GOTO L0
;
CRD1  !("µ“√ﬁƒ≥ !!"0D)
 !(" ±≈¿  , 30“› æﬁ›Ãﬁ ¶ ∏ÿ± ºœº¿°"0D)
 !(" ¥√ﬁ®¿- ¶ ¬∂Ø√ ’∆-∏ ≈ µÿºﬁ≈Ÿ …"0D)
 !(" “› ¶ ¬∏Ø√ ¿…º›√ﬁ ∏¿ﬁª≤°"0D)
 !(" Let's try again "22"XETTER '91"220D)
CRD6  !(" PUSH [SPACE] KEY"0D)
;
PS    HL=PSOD2 DE=PSOD1 BC=8 LDIR
 DE=(PSDS1) A=(DE) IF A="*" THEN DE=PSD1
 A=1 !PSET (PSDS1)=DE
 DE=(PSDS2) A=(DE) IF A="*" THEN DE=PSD2
 A=2 !PSET (PSDS2)=DE
 DE=(PSDS3) A=(DE) IF A="*" THEN DE=PSD3
 A=3 !PSET (PSDS3)=DE
 DE=(PSDS4) A=(DE) IF A="*" THEN DE=PSD4
 A=4 !PSET (PSDS4)=DE
 DE=(PSDS5) A=(DE) IF A="*" THEN DE=PSD5
 A=5 !PSET (PSDS5)=DE
 DE=(PSDS6) A=(DE) IF A="*" THEN DE=PSD6
 A=6 !PSET (PSDS6)=DE
 A=1 !PSOUT
 RET
;
PSOUT IF A=0 THEN HL=PSOD0 GOTO PSO0
 HL=PSOD1
PSO0  C=$90 DO B=4
 A=(HL+) A=A.OR.C PORT($F2)=A
 A=$20 A=A+C C=A
 UNTIL DEC(B)=0
 C=$90 DO B=4
 A=(HL+) A=A.OR.C PORT($F3)=A
 A=$20 A=A+C C=A
 UNTIL DEC(B)=0
 RET
;
PSOD0 DEFB 15:15:15:15:15:15:15:15
PSOD1 DEFS 8
PSOD2 DEFB 0:9:4:15:4:9:4:15
;
PSDS1 DEFS 2
PSDS2 DEFS 2
PSDS3 DEFS 2
PSDS4 DEFS 2
PSDS5 DEFS 2
PSDS6 DEFS 2
;
PSET  AF<>AF'
 A=(DE+) IF A<>"H" GOTO PSET0
 HL=PSOD1 AF<>AF' B=A AF<>AF'
 A=B A- IF A>=3 THEN A+
 A=A+L IF CY THEN H+
 L=A (HL)=15
 A="H"
PSET0 A=A-"A" A=A+A
 HL=PSETD A=A+L IF CY THEN H+
 L=A C=(HL+) B=(HL)
 A=(DE+) DO A=A-"0"
 SRL(B) RR(C)
 UNTIL DEC(A)=0
 L=C AF<>AF'
 C=$F2 IF A>=4 THEN C+ A=A-3
 A- A=A+A
 A=A+8 RL(A) RL(A) RL(A) RL(A)
 H=A A=L A=A.AND.$F
 A=A.OR.H PORT(C)=A
 DO A=4
 SRL(B) RR(L)
 UNTIL DEC(A)=0
 PORT(C)=L
 RET
;
PSETD DEFW 1017:906:1710:1524:1358:1281:1142:0
;
PSD1 !("G2G2F2E2G2G2A2B2G2G2F2D2A2A2A2E2G2G2F2E2G2G2A2B2G2G2A2G2C3C3C3H1")
 !("C3C3D3E3C3C3B2A2D2E2F2G2A2G2E2E2C3C3D3E3C3C3B2A2C2E2G2G2C3E3C3H1*")
PSD2 !("C3C3C3C3E3E3E3E3G3G3G3G3E3E3E3E3C3C3C3C3E3E3E3E3G3G3G3G3C4C4C4C4")
 !("G3G3G3G3C4C4C4C4E4E4E4E4C4C4C4C4G3G3G3G3C4C4C4C4D4D4D4D4C4C4C4C4*")
PSD3 !("C1H1H1H1C1C1H1H1C1H1H1H1C1C1H1H1C1H1H1H1C1C1H1H1C1H1H1H1C1C1C1H1")
 !("C1H1C1H1C1H1C1C1C1H1C1H1C1H1C1C1C1H1C1H1C1H1C1C1C1H1C1H1C1C1C1H1*")
PSD4 !("G1G1F1E1G1G1A1B1G1G1F1D1A1A1A1E1G1G1F1E1G1G1A1B1G1G1A1G1C2C2C2H1")
 !("C2C2D2E2C2C2B1A1D1E1F1G1A1G1E1E1C2C2D2E2C2C2B1A1C1E1G1G1C2E2C2H1*")
PSD5 !("C2C2C2C2E2E2E2E2G2G2G2G2E2E2E2E2C2C2C2C2E2E2E2E2G2G2G2G2C3C3C3C3")
 !("G2G2G2G2C3C3C3C3E3E3E3E3C3C3C3C3G2G2G2G2C3C3C3C3D3D3D3D3C3C3C3C3*")
PSD6 !("H1H1G1G1H1H1H1G1H1H1G1G1H1H1H1G1H1H1G1G1H1H1H1G1H1H1G1G1G1G1G1H1")
 !("H1G1H1G1H1G1G1G1H1G1H1G1H1G1G1G1H1G1H1G1H1G1G1G1H1G1H1G1G1G1G1H1*")
;
PPSS  DEFS 1
;
IMOVE A=(PPSS) A=A+$80 (PPSS)=A
 IF Z GOSUB PS
 DO B=70
 DO C=0
 UNTIL DEC(C)=0
 UNTIL DEC(B)=0
 !GETK
 IF A=$14 GOTO IM4
 IF A=$13 GOTO IM6
 IF A=$11 GOTO IM2
 IF A=$12 GOTO IM8
 IF A="!" THEN A=1 (BOM)=A
 IF A=""" THEN A=1 (BOM)=A (MY)=A
 IF A<>"Q" RET
 A=0 !PSOUT
IMQ   !GETKY IF A<>" " GOTO IMQ
 RET
;
IM4   HL=(MYX)
 !XHL
 HL- A=(HL)
 B=A DE=40
 HL=HL+DE
 A=(HL)
 IF A<>B GOTO IM4S
 IF A=5 GOTO IM4P
 IF A=4 THEN A=(CLR) A-- (CLR)=A HL=(SC) HL++ (SC)=HL A=5
 IF A=2 THEN A=1
 IF A=1 THEN (BOM)=A
 IF A=3 GOTO IM4E
IM4PS HL=(MYX)
 (GX)=HL
 A=0 (GZ)=A
 !PUT
 A=(MYX)
 A- (MYX)=A
 A=(MA) A=A.XOR.$FF (MA)=A
IM4P  HL=(MYX)
 (GX)=HL
 A=8 (GZ)=A
 !PUT
 RET
;
IM4E  HL=(MYX)
 !XHL
 HL-- HL-
 A=(HL) B=A
 DE=40 HL=HL+DE
 A=(HL)
 IF A<>B GOTO IM4P
 IF A<>0 GOTO IM4P
 A=4 !ISECH
 IF HL=0 GOTO IM4P
 A=(HL) A-
 (HL)=A
 HL=(MYX) L--
 (GX)=HL
 A=0 (GZ)=0
 !PUT
 L-
 (GX)=HL
 A=3 (GZ)=A
 !PUT
 GOTO IM4PS
;
ISECH HL=(MYX)
 IF A=4 THEN L--
 IF A=6 THEN L++
 BC=IWA1 DE=HL A=0
ISH0  [AF A=(BC) BC+
 L=A A=(BC)
 H=A BC+
 A=(BC) BC+
 IF A=0 GOTO ISH1
 HL=HL-DE
 IF H<>0 GOTO ISH1
 IF L<>0 GOTO ISH1
 ]AF BC-- BC-
 HL=BC
 RET
;
ISH1  ]AF A+
 IF A=15 THEN HL=0 RET
 GOTO ISH0
;
IM6   HL=(MYX)
 !XHL
 HL++ A=(HL)
 B=A
 DE=40 HL=HL+DE
 A=(HL)
 IF A<>B GOTO IM6S
 IF A=5 GOTO IM6P
 IF A=4 THEN A=(CLR) A-- (CLR)=A HL=(SC) HL++ (SC)=HL A=5
 IF A=2 THEN A=1
 IF A=1 THEN (BOM)=A
 IF A=3 GOTO IM6E
IM6PS HL=(MYX)
 (GX)=HL
 A=0 (GZ)=A
 !PUT
 A=(MYX)
 A+ (MYX)=A
 A=(MA) A=A.XOR.$FF (MA)=A
IM6P  HL=(MYX)
 (GX)=HL
 A=9 (GZ)=A
 !PUT
 RET
;
IM6E  HL=(MYX)
 !XHL
 HL++ HL++
 A=(HL) B=A
 DE=40 HL=HL+DE
 A=(HL)
 IF A<>B GOTO IM6P
 IF A<>0 GOTO IM6P
 A=6 !ISECH
 IF HL=0 GOTO IM6P
 A=(HL) A+
 (HL)=A
 HL=(MYX) L++
 (GX)=HL
 A=0 (GZ)=0
 !PUT
 L+
 (GX)=HL
 A=3 (GZ)=A
 !PUT
 GOTO IM6PS
;
IM2   HL=(MYX)
 !XHL DE=80
 HL=HL+DE A=(HL)
 B=A
 HL+
 A=(HL)
 IF A<>B GOTO IM2S
 IF A=5 GOTO IM2P
 IF A=4 THEN A=(CLR) A-- (CLR)=A HL=(SC) HL++ (SC)=HL A=5
 IF A=2 THEN A=1
 IF A=1 THEN (BOM)=A
 IF A=3 GOTO IM2P
IM2PS HL=(MYX)
 (GX)=HL
 A=0 (GZ)=A
 !PUT
 A=(MYY)
 A+ (MYY)=A
IM2P  HL=(MYX)
 (GX)=HL
 A=7 (GZ)=A
 !PUT
 RET
;
IM8   HL=(MYX)
 !XHL DE=40
 HL=HL-DE A=(HL)
 B=A
 HL+
 A=(HL)
 IF A<>B GOTO IM8S
 IF A=5 GOTO IM8P
 IF A=4 THEN A=(CLR) A-- (CLR)=A HL=(SC) HL++ (SC)=HL A=5
 IF A=2 THEN A=1
 IF A=1 THEN (BOM)=A
 IF A=3 GOTO IM8P
IM8PS HL=(MYX)
 (GX)=HL
 A=0 (GZ)=A
 !PUT
 A=(MYY)
 A- (MYY)=A
IM8P  HL=(MYX)
 (GX)=HL
 A=6 (GZ)=A
 !PUT
 RET
;
XHL   [DE [BC [AF
 DE=HL
 HL=GAMEN-40
 B=D D=0
 HL=HL+DE DE=40
 DO B+
 HL=HL+DE
 UNTIL DEC(B)=0
 ]AF ]BC ]DE
 RET
;
IM4S  IF A=5 GOTO IM4P
 B-- B-- B- IF B=0 GOTO IM4P
 IF A=3 GOTO IM4P
 B++ IF B=0 GOTO IM4P
 B+ IF A=1 THEN IF B=0 GOTO IM4SA
 B+ IF A=2 THEN IF B=0 GOTO IM4SA
 B+ IF A=1 THEN IF B=0 GOTO IM4SA
 B- IF B=0 THEN IF A=0 GOTO IM4SA
 B+ IF A=2 THEN IF B=0 GOTO IM4SA
 B-- IF B=0 THEN IF A=0 GOTO IM4SA
 B-- IF A=1 THEN IF B=0 GOTO IM4SB
 B++ B+ IF B=0 THEN IF A=4 GOTO IM4SB
 B-- B- IF A=2 THEN IF B=0 GOTO IM4SB
 B++ IF B=0 THEN IF A=4 GOTO IM4SB
 HL=(SC) HL+ (SC)=HL A=(CLR) A- (CLR)=A GOTO IM4PS
IM4SA A=1 (BOM)=A GOTO IM4PS
IM4SB A=1 (BOM)=A HL=(SC) HL+ (SC)=HL
 A=(CLR) A- (CLR)=A GOTO IM4PS
;
IM6S  IF A=5 GOTO IM6P
 B-- B-- B- IF B=0 GOTO IM6P
 IF A=3 GOTO IM6P
 B++ IF B=0 GOTO IM6P
 B+ IF A=1 THEN IF B=0 GOTO IM6SA
 B+ IF A=2 THEN IF B=0 GOTO IM6SA
 B+ IF A=1 THEN IF B=0 GOTO IM6SA
 B- IF B=0 THEN IF A=0 GOTO IM6SA
 B+ IF A=2 THEN IF B=0 GOTO IM6SA
 B-- IF B=0 THEN IF A=0 GOTO IM6SA
 B-- IF A=1 THEN IF B=0 GOTO IM6SB
 B++ B+ IF B=0 THEN IF A=4 GOTO IM6SB
 B-- B- IF A=2 THEN IF B=0 GOTO IM6SB
 B++ IF B=0 THEN IF A=4 GOTO IM6SB
 HL=(SC) HL+ (SC)=HL A=(CLR) A- (CLR)=A GOTO IM6PS
IM6SA A=1 (BOM)=A GOTO IM6PS
IM6SB A=1 (BOM)=A HL=(SC) HL+ (SC)=HL
 A=(CLR) A- (CLR)=A GOTO IM6PS
;
IM2S  IF A=5 GOTO IM2P
 B-- B-- B- IF B=0 GOTO IM2P
 IF A=3 GOTO IM2P
 B++ IF B=0 GOTO IM2P
 B+ IF A=1 THEN IF B=0 GOTO IM2SA
 B+ IF A=2 THEN IF B=0 GOTO IM2SA
 B+ IF A=1 THEN IF B=0 GOTO IM2SA
 B- IF B=0 THEN IF A=0 GOTO IM2SA
 B+ IF A=2 THEN IF B=0 GOTO IM2SA
 B-- IF B=0 THEN IF A=0 GOTO IM2SA
 B-- IF A=1 THEN IF B=0 GOTO IM2SB
 B++ B+ IF B=0 THEN IF A=4 GOTO IM2SB
 B-- B- IF A=2 THEN IF B=0 GOTO IM2SB
 B++ IF B=0 THEN IF A=4 GOTO IM2SB
 HL=(SC) HL+ (SC)=HL A=(CLR) A- (CLR)=A GOTO IM2PS
IM2SA A=1 (BOM)=A GOTO IM2PS
IM2SB A=1 (BOM)=A HL=(SC) HL+ (SC)=HL
 A=(CLR) A- (CLR)=A GOTO IM2PS
;
IM8S  IF A=5 GOTO IM8P
 B-- B-- B- IF B=0 GOTO IM8P
 IF A=3 GOTO IM8P
 B++ IF B=0 GOTO IM8P
 B+ IF A=1 THEN IF B=0 GOTO IM8SA
 B+ IF A=2 THEN IF B=0 GOTO IM8SA
 B+ IF A=1 THEN IF B=0 GOTO IM8SA
 B- IF B=0 THEN IF A=0 GOTO IM8SA
 B+ IF A=2 THEN IF B=0 GOTO IM8SA
 B-- IF B=0 THEN IF A=0 GOTO IM8SA
 B-- IF A=1 THEN IF B=0 GOTO IM8SB
 B++ B+ IF B=0 THEN IF A=4 GOTO IM8SB
 B-- B- IF A=2 THEN IF B=0 GOTO IM8SB
 B++ IF B=0 THEN IF A=4 GOTO IM8SB
 HL=(SC) HL+ (SC)=HL A=(CLR) A- (CLR)=A GOTO IM8PS
IM8SA A=1 (BOM)=A GOTO IM8PS
IM8SB A=1 (BOM)=A HL=(SC) HL+ (SC)=HL
 A=(CLR) A- (CLR)=A GOTO IM8PS
;
EMOVE HL=IWA1
 DO B=15
 !EMS
 A=(BOM)
 IF A=1 RET
 HL++ HL+
 UNTIL DEC(B)=0
 RET
;
EMS   [HL [BC
 (EMSMC)=0
 DE=HL
 HL++ A=(HL)
 IF A=0 THEN ]BC ]HL RET
 HL--
 HL=(HL)
 !XHL
 HL=HL+80
 A=(HL)
 IF A=5 THEN ]BC ]HL RET
 IF A=4 THEN ]BC ]HL RET
 IF A=3 THEN ]BC ]HL RET
 B=A HL+
 A=(HL)
 IF A=5 THEN ]BC ]HL RET
 IF A=4 THEN ]BC ]HL RET
 IF A=3 THEN ]BC ]HL RET
 IF A=0 THEN IF B=0 GOTO EMS1
 !EMS0
EMS1  HL=DE
 HL=(HL)
 (GX)=HL
 (GZ)=0
 !PUT
 HL=DE HL+
 A=(HL) A+
 (HL)=A HL-
 HL=(HL)
 (GX)=HL
 (GZ)=3
 !PUT
EMS2  A=(EMSMC)
 IF A<>0 THEN A- (EMSMC)=A DE=MS !MELDY GOTO EMS2
 ]BC ]HL
 RET
;
EMS0  IF A<>B GOTO EMS0S
 IF A=6 GOTO IDED
 HL=DE HL=(HL)
 !ESECH
 IF HL=0 GOTO EMS0S
 (EMSMC)=1
 HL++ A=2
 (HL)=A
 HL- A=(HL)
 A+ (HL)=A
 HL- HL=(HL)
 (GX)=HL
 A=B A=A+10
 (GZ)=A
 !SPUT
 HL=(SC)
 HL=HL+20
 (SC)=HL
 RET
;
MS    !("+C1+E+G"0D)
;
IDED  A=1 (BOM)=A
 A=(MYY)
 A+ (MYY)=A
 HL=(MYX)
 (GX)=HL
 A=10 (GZ)=A
 !SPUT
 RET
;
ESECH [DE [BC
 H++ DE=HL
 BC=T11 A=0
ESE   [AF A=(BC) BC+
 L=A A=(BC)
 H=A BC+
 A=(BC) BC+
 IF A=2 GOTO ESES
 IF A=0 GOTO ESES
 HL=HL-DE
 IF H<>0 GOTO ESES
 IF L<>0 GOTO ESES
 ]AF BC-- BC-
 HL=BC
 ]BC ]DE
 RET
;
ESES  ]AF A+
 IF A=8 THEN ]BC ]DE HL=0 RET
 GOTO ESE
;
EMSMC DEFS 1
;
EMS0S HL=DE
 HL=(HL) !XHL
 HL=HL+79
 EXX
 HL=0
 EXX
 A=(HL)
 IF A=6 GOTO EMI
 [AF !SECH
 IF HL=0 THEN ]AF GOTO EMS1S
 (EMSMC)=1
 [HL
 HL=(HL)
 (GX)=HL
 (GZ)=0
 !PUT ]HL
 ]AF HL++ B=A
 A=2 (HL)=A
 HL- A=(HL)
 A+ (HL)=A
 HL-
 HL=(HL)
 (GX)=HL
 A=B
 A=A+10
 (GZ)=A
 !SPUT
 HL=(SC)
 HL=HL+20
 (SC)=HL
EMS1S HL=DE
 HL=(HL) !XHL
 HL=HL+81
 EXX
 HL=1
 EXX
 A=(HL)
 IF A=6 GOTO EMI
 [AF !SECH
 IF HL=0 THEN ]AF RET
 [HL HL=EMSMC (HL)+ ]HL
 [HL HL=(HL)
 (GX)=HL
 A=0 (GZ)=A
 !PUT ]HL
 ]AF HL++ B=A
 A=2 (HL)=A
 HL- A=(HL)
 A+ (HL)=A
 HL-
 HL=(HL)
 (GX)=HL
 A=B
 A=A+10
 (GZ)=A
 !SPUT
 HL=(SC)
 HL=HL+20
 (SC)=HL
 RET
;
SECH  [DE
 HL=DE HL=(HL) H++
 L+ DE=HL BC=T11
 EXX [HL EXX ]HL
 IF HL=0 THEN E--
 A=0
SECH1 [AF A=(BC) BC+
 L=A A=(BC)
 H=A BC+
 A=(BC) BC+
 IF A=2 GOTO SECH2
 IF A=0 GOTO SECH2
 HL=HL-DE
 IF H<>0 GOTO SECH2
 IF L<>0 GOTO SECH2
 ]AF BC-- BC-
 HL=BC
 ]DE
 RET
;
SECH2 ]AF A+
 IF A=8 THEN ]DE HL=0 RET
 GOTO SECH1
;
EMI   (BOM)=1
 HL=(MYX)
 (GX)=HL
 (GZ)=0
 !PUT
 A=(MYY)
 A+ (MYY)=A
 HL=(MYX)
 (GX)=HL
 A=10 (GZ)=A
 !SPUT
 EXX
 [HL
 EXX
 ]HL
 IF HL=0 GOTO EMS1S
 RET
;
YMOVE HL=T11
 DO B=4 A=1
 !T1E HL++ HL+
 UNTIL DEC(B)=0
 DO B=4 A=2
 !T1E HL++ HL+
 UNTIL DEC(B)=0
 RET
;
ARD   DEFS 8
;
AR    BC=ARD
 HL=(HL) !XHL
 HL=HL-40
 A=(HL) (BC)=A
 BC+ HL+
 A=(HL) (BC)=A
 BC+ HL=HL+38
 A=(HL) (BC)=A
 BC+ HL=HL+40
 A=(HL) (BC)=A
 BC+ HL=HL-37
 A=(HL) (BC)=A
 BC+ HL=HL+40
 A=(HL) (BC)=A
 BC+ HL=HL+38
 A=(HL) (BC)=A
 BC+ HL+
 A=(HL) (BC)=A
 RET
;
ARSD  DEFS 4
;
ARS   (ARSD)=0 (ARSD+1)=0
 (ARSD+2)=0 (ARSD+3)=0
 BC=ARD
 HL=ARSD
 DO A=4
 [AF
 A=(BC)
 IF A<>0 THEN IF A<>6 GOTO ARSE1
 BC+
 A=(BC) BC-
 IF A<>0 THEN IF A<>6 GOTO ARSE1
 (HL)=1
ARSE1 BC++ HL+
 ]AF
 UNTIL DEC(A)=0
 RET
;
T1E1  HL=DE
 HL=(HL)
 A=(ARSD) IF A=1 THEN H- GOTO T1E1U
 A=(ARSD+1) IF A=1 THEN L- GOTO T1E1L
 A=(ARSD+3) IF A=1 THEN H+ GOTO T1E1D
 A=(ARSD+2) IF A=1 THEN L+ GOTO T1E1R
;
T1E1D BC=HL
 !XHL HL=HL+40
 A=(HL) IF A=6 THEN (BOM)=1
 HL+
 A=(HL) IF A=6 THEN (BOM)=1
 HL=DE HL=(HL)
 (GX)=HL A=0 (GZ)=A !PUT
 ]HL ]AF [AF [HL HL=BC
 (GX)=HL (GZ)=A !PUT
 HL<>DE (HL)=DE
 ]HL ]AF ]BC
 RET
;
T1E1R BC=HL
 !XHL HL+
 A=(HL) IF A=6 THEN (BOM)=1
 HL=HL+40
 A=(HL) IF A=6 THEN (BOM)=1
 HL=DE HL=(HL)
 (GX)=HL A=0 (GZ)=A !PUT
 ]HL ]AF [AF [HL HL=BC
 (GX)=HL (GZ)=A !PUT
 HL<>DE (HL)=DE
 ]HL ]AF ]BC
 RET
;
T1E1U BC=HL
 !XHL
 A=(HL) IF A=6 THEN (BOM)=1
 HL+
 A=(HL) IF A=6 THEN (BOM)=1
 HL=DE HL=(HL)
 (GX)=HL A=0 (GZ)=A !PUT
 ]HL ]AF [AF [HL HL=BC
 (GX)=HL (GZ)=A !PUT
 HL<>DE (HL)=DE
 ]HL ]AF ]BC
 RET
;
T1E1L BC=HL
 !XHL
 A=(HL) IF A=6 THEN (BOM)=1
 HL=HL+40
 A=(HL) IF A=6 THEN (BOM)=1
 HL=DE HL=(HL)
 (GX)=HL A=0 (GZ)=A !PUT
 ]HL ]AF [AF [HL HL=BC
 (GX)=HL (GZ)=A !PUT
 HL<>DE (HL)=DE
 ]HL ]AF ]BC
 RET
;
TEC   HL++ (HL)=0
 HL-- HL=(HL)
 (GX)=HL
 A=0 (GZ)=A
 !SPUT
 ]HL ]AF ]BC
 RET
;
T1E   [BC [AF [HL
 DE=HL HL++
 A=(HL) HL--
 IF A=0 THEN ]HL ]AF ]BC RET
 IF A=2 GOTO TEC
 !AR !ARS
 HL=ARSD C=0
 DO B=4
 A=(HL)
 A=A+C C=A
 HL+
 UNTIL DEC(B)=0
 IF C=0 THEN ]HL ]AF ]BC RET
 C- IF C=0 GOTO T1E1
 HL=DE HL=(HL)
 (HLS)=HL
 ]HL ]AF [AF [HL
 HL=(HLS)
 IF A=1 GOTO T2E
 A=(DE) B=A
 A=(MYX)
 IF A<>B GOTO T1ES
 A=(+DE-)
 B=A A=(MYY)
 IF A>=B GOTO T1E0
 A=(ARSD)
 IF A=1 THEN H- GOTO T1E1U
 GOTO T1ES
T1E0  A=(ARSD+3)
 IF A=1 THEN H+ GOTO T1E1D
T1ES  A=(+DE-) B=A
 A=(MYY)
 IF A<>B GOTO RMOVE
 A=(DE)
 B=A A=(MYX)
 IF A>=B GOTO T1E2
 A=(ARSD+1)
 IF A=1 THEN L- GOTO T1E1L
 GOTO RMOVE
T1E2  A=(ARSD+2)
 IF A=1 THEN L+ GOTO T1E1R
 GOTO RMOVE
;
HLS   DEFS 2
;
RND    [DE [HL
 HL<>DE DE=(HL) DE<>HL
 DE=HL HL=(RNDD)
 HL=HL+DE
 A=H A=A+L
 L=A A=A+H
 L=A DE=$36
 HL=HL+DE (RNDD)=HL
 A=L ]HL ]DE
 RET
;
RNDD  !(1234)
;
RMOVE B=4
RMOV1 HL=DE HL=(HL) !RND
 IF DEC(B)=0 GOTO T1E1
 IF A>=0 THEN IF A<$40 GOTO RM0
 IF A>=$40 THEN IF A<$80 GOTO RM1
 IF A>=$80 THEN IF A<$C0 GOTO RM2
 GOTO RM3
;
RM0   A=(ARSD) IF A=1 THEN H- GOTO T1E1U
 GOTO RMOV1
;
RM1   A=(ARSD+1) IF A=1 THEN L- GOTO T1E1L
 GOTO RMOV1
;
RM2   A=(ARSD+2) IF A=1 THEN L+ GOTO T1E1R
 GOTO RMOV1
;
RM3   A=(ARSD+3) IF A=1 THEN H+ GOTO T1E1D
 GOTO RMOV1
;
T2E   A=(DE)
 B=A A=(MYX)
 IF A=B GOTO T2ES
 IF A>=B GOTO T2E0
 A=(ARSD+1)
 IF A=1 THEN L- GOTO T1E1L
 GOTO RMOVE
T2E0  A=(ARSD+2)
 IF A=1 THEN L+ GOTO T1E1R
 GOTO RMOVE
T2ES  A=(+DE-)
 B=A A=(MYY)
 IF A>=B GOTO T2E1
 A=(ARSD)
 IF A=1 THEN H- GOTO T1E1U
 GOTO RMOVE
T2E1  A=(ARSD+3)
 IF A=1 THEN H+ GOTO T1E1D
 GOTO RMOVE
;
EDIT0 !("EDITOR COMMAND (1-5) ?"0D)
 !("      1. EDIT"0D)
 !("      2. DATA LOAD"0D)
 !("      3. DATA SAVE"0D)
 !("      4. DEVICE CHANGE"0D)
 !("      5. END"0D)
;
EDIT  !VC A=1 (ED)=A A=0
 DE=EDIT0 !PRNT (LOCX)=A
 !PRNT (LOCX)=A
 !PRNT (LOCX)=A
 !PRNT (LOCX)=A
 !PRNT (LOCX)=A
 !PRNT
ED0   A="" ($D469)=A !KD5
 A=" " ($D469)=A !KD5
 GOTO ED0
;
KD5   ]HL DO B=50
 !GETKY
 IF A="1" GOTO EDITR
 IF A="2" GOTO LOAD
 IF A="3" GOTO SAVE
 IF A="4" GOTO B.C
 IF A="5" GOTO DEMO
 UNTIL DEC(B)=0
 [HL RET
;
EDITL !("** LOAD **"0D)
EDITS !("** SAVE **"0D)
EDITV !("** DEVICE CHANGE **"0D)
EDITT !("√ﬁ ﬁ≤Ω ¶ æØƒ º¿◊ [CR] ¶ µº√∏¿ﬁª≤°"0D)
;
SAVE  !VC DE=EDITS !PRNT
 DE=EDITT !PRNT HL=$400 (LOCX)=HL
SAVE0 !GETKY IF A="d" GOTO EDIT
 IF A<>"f" GOTO SAVE0
 A=4 DE=SAVED !$1FA3
 HL=$3000 ($1F6E)=HL
 HL=END   ($1F70)=HL
 HL=5700  ($1F72)=HL
 DE=WD !PRNT
 !$1FAF IF CY GOTO BREAK
 !$1FAC IF CY GOTO BREAK
 GOTO EDIT
;
BREAK A=0 (LOCX)=A DE=BRK !PRNT !BELL
BR2   A=0 (LOCX)=A DE=PUCR !PRNT
BR1   !GETKY IF A<>"f" GOTO BR1
 GOTO EDIT
;
WD    !("Writing ")
SAVED !("XETTER '91.Dat"00)
SKIP  !("Skip "0D)
LING  !("Loading "0D)
BRK   !("*Break"0D)
ERR   !("*Error"0D)
PUCR  !("Push [CR] key."0D)
;
LOAD  !VC DE=EDITL !PRNT
 DE=EDITT !PRNT HL=$300 (LOCX)=HL
LOAD0 !GETKY IF A="d" GOTO EDIT
 IF A<>"f" GOTO LOAD0
LOAD2 A=4 DE=SAVED !$1FA3
 !$2009 IF CY GOTO ERROR
 IF NZ GOTO LOAD1
 HL=($1F72) DE=5700 HL=HL-DE
 IF NZ GOTO LOAD1
 DE=LING !PRNT DE=SAVED !PRNT
 HL=END ($1F70)=HL
 !$1FA6 IF CY GOTO ERROR
 GOTO EDIT
;
ERROR !BRKEY IF Z GOTO BREAK
 A=0 (LOCX)=A DE=ERR !PRNT !BELL
 GOTO BR2
;
LOAD1 DE=SKIP !PRNT DE=($1F74) DE+ !PRNT HL=LOCX (HL)=0 HL+
 (HL)+ !WAIT0 GOTO LOAD2
;
B.C   !VC DE=EDITV !PRNT
B.C0  DE=EDITB !PRNT !$2024 (DE)=A !PRNT
VRFY0 !GETKY IF A="f" GOTO EDIT
 IF A=0 GOTO VRFY0
 IF A<"A" GOTO VRFY0
 IF A>="[" GOTO VRFY0
 !$2027 GOTO B.C0
;
EDITB !("   Now , DEVICE is "0D)
EDITC !("    Push DEVICE key.")
 !("   If end , then 'Push [CR] key.'"0D)
;
EDT1  HL=(MYX) RLC(H) RLC(L) (GX)=HL
 !MPUT0 A=(HL) A=A-$30 IF CY THEN A=0
 (GZ)=A !PUT
 RET
;
CURN  !(""0D)
;
EDT9  A=(MYX) RLC(A) A+ (LOCX)=A
 A=(MYY) RLC(A) A=A+4 (LOCY)=A
 DE=CURN !PRNT
 RET
;
EDITR !VC DE=EDITD
 !SLCTT
 IF CY GOTO EDIT
EDT2  !S3
 A=1 (MYX)=A
EDT0  !EDT9 !KD7
 !EDT1 !KD7
 GOTO EDT0
;
KD7   ]HL
 DO B=30 !GETKY
 IF A=$11 GOTO CURD
 IF A=$14 GOTO CURL
 IF A=$13 GOTO CURR
 IF A=$12 GOTO CURU
 IF A=" " GOTO CHR0
 IF A="Z" GOTO CHR4
 IF A="X" GOTO CHR5
 IF A="C" GOTO CHR2
 IF A="V" GOTO CHR1
 IF A="B" GOTO CHR3
 IF A="E" GOTO EDIT
 IF A=$60 GOTO MENU
 IF A="a" GOTO MEND
 IF A="!" GOTO SCRCL
 UNTIL DEC(B)=0
 [HL RET
;
CURD  !EDT1 A=(MYY) IF A=9 GOTO EDT0
 A+ (MYY)=A GOTO EDT0
;
CURR  !EDT1 A=(MYX) IF A=18 GOTO EDT0
 A+ (MYX)=A GOTO EDT0
;
CURU  !EDT1 A=(MYX) B=A A=(MYY)
 IF A=1 THEN IF B=0 GOTO EDT0
 IF A=0 GOTO EDT0
 A- (MYY)=A GOTO EDT0
;
CURL  !EDT1 A=(MYY) B=A A=(MYX)
 IF A=1 THEN IF B=0 GOTO EDT0
 IF A=0 GOTO EDT0
 A- (MYX)=A GOTO EDT0
;
MC    [HL [DE [BC
 HL=END-190 DE=190
 DO
 HL=HL+DE
 UNTIL DEC(A)=0
 A=(HL) CP(A-"6")
 ]BC ]DE ]HL
 RET
;
MENU  A=(MEN)
 DO B=29
 A+ IF A=31 THEN A=1
 [AF !MC
 IF Z THEN ]AF (MEN)=A GOTO EDT2
 ]AF UNTIL DEC(B)=0
 GOTO EDT0
;
MEND  A=(MEN)
 DO B=29
 A- IF Z THEN A=30
 [AF !MC
 IF Z THEN ]AF (MEN)=A GOTO EDT2
 ]AF UNTIL DEC(B)=0
 GOTO EDT0
;
SCRCL !EDT1 A=0 (MYY)=A (GZ)=A A+ (MYX)=A
SCRC0 !MGET A=(MYX) RLC(A) (GX)=A
 A=(MYY) RLC(A) (GY)=A !PUT
 !MPUT0 A=" " (HL)=A
 A=(MYX) A+ (MYX)=A IF A<>19 GOTO SCRC0
 A=0 (MYX)=A
 A=(MYY) A+ (MYY)=A IF A<>10 GOTO SCRC0
 A=0 (MYY)=A A+ (MYX)=A
 GOTO EDT0
;
CHR0  !MGET A=(MYX) RLC(A) (GX)=A
 A=(MYY) RLC(A) (GY)=A
 A=0 (GZ)=A !PUT
 A=" " GOTO MPUT
;
MPUT  AF<>AF' !MPUT0
 AF<>AF' (HL)=A
 GOTO EDT0
;
CHR1  !MGET A=(MYX) RLC(A) (GX)=A
 A=(MYY) RLC(A) (GY)=A
 A=5 (GZ)=A !PUT
 A="5" GOTO MPUT
;
CHR2  A=(CLR) A=A+4
 IF CY GOTO EDT0
 (CLR)=A !MGET
 A=(MYX) RLC(A) (GX)=A
 A=(MYY) RLC(A) (GY)=A
 A=4 (GZ)=A !PUT
 A="4" GOTO MPUT
;
CHR3  HL=IWA1-1 DO B=15 HL++ HL+
 A=(HL) IF A=0 THEN A+ (HL)=A GOTO CHR30
 UNTIL DEC(B)=0
 GOTO EDT0
CHR30 !MGET A=(MYX) RLC(A) (GX)=A A=(MYY)
 RLC(A) (GY)=A A=3 (GZ)=A !PUT
 A="3" GOTO MPUT
;
CHR4  HL=T11-1 DO B=4 HL++ HL+
 A=(HL) IF A=0 THEN A+ (HL)=A GOTO CHR40
 UNTIL DEC(B)=0
 GOTO EDT0
CHR40 !MGET A=(MYX) RLC(A) (GX)=A A=(MYY)
 RLC(A) (GY)=A A=1 (GZ)=A !PUT
 A="1" GOTO MPUT
;
CHR5  HL=T21-1 DO B=4 HL++ HL+
 A=(HL) IF A=0 THEN A+ (HL)=A GOTO CHR50
 UNTIL DEC(B)=0
 GOTO EDT0
CHR50 !MGET A=(MYX) RLC(A) (GX)=A A=(MYY)
 RLC(A) (GY)=A A=2 (GZ)=A !PUT
 A="2" GOTO MPUT
;
MPUT0 A=(MEN)
 HL=END-209 DE=190
 DO B=A
 HL=HL+DE
 UNTIL DEC(B)=0
 A=(MYX) B=0 C=A HL=HL+BC
 A=(MYY) A+ DE=19
 DO B=A
 HL=HL+DE
 UNTIL DEC(B)=0
 RET
;
MGET  !MPUT0 A=(HL)
 IF A=" " RET
 IF A="5" RET
 IF A="4" THEN A=(CLR) A=A-4 (CLR)=A RET
 IF A="1" GOTO MGET0
 IF A="2" GOTO MGET1
 IF A<>"3" RET
 HL=IWA1+2 DO B=14 HL++ HL+
 A=(HL) IF A=0 THEN HL-- HL- GOTO MGET2
 UNTIL DEC(B)=0
MGET2 A=0 (HL)=A RET
;
MGET0 HL=T11+2 DO B=3 HL++ HL+
 A=(HL) IF A=0 THEN HL-- HL- GOTO MGET2
 UNTIL DEC(B)=0
 GOTO MGET2
;
MGET1 HL=T21+2 DO B=3 HL++ HL+
 A=(HL) IF A=0 THEN HL-- HL- GOTO MGET2
 UNTIL DEC(B)=0
 GOTO MGET2
;
 !("No.19")
 !("[by K.Kuromusha]")
;
END
;1
 !("7                  ")
 !(" 5555 555 555 5555 ")
 !("  3     3 3     3  ")
 !(" 55 555 555 555 55 ")
 !(" 3   3   3   3   3 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !(" 545454545454545451")
 !("   4           4  2")
 !("4545454545454545454")
;2
 !("735 3    3    3 52 ")
 !(" 45 44444444444 54 ")
 !(" 55 44444444444 55 ")
 !("                   ")
 !(" 44444444444444444 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !("        1 1        ")
 !("4545454545454545454")
;3
 !("7       3          ")
 !("        3          ")
 !("        3          ")
 !("        3          ")
 !("        3          ")
 !("        3          ")
 !("        3          ")
 !("        3          ")
 !("      5 5 5      12")
 !("5454545454545454545")
;4
 !("7                  ")
 !(" 55443455 55555555 ")
 !(" 55544555 55555555 ")
 !(" 55555555 34444553 ")
 !(" 55455455 44445544 ")
 !(" 55434455 44554444 ")
 !(" 55444455 45544444 ")
 !(" 55444455 55555555 ")
 !(" 55444455 55555555 ")
 !("         2         ")
;5
 !("7        3         ")
 !(" 454 55555 454 454 ")
 !(" 554 54444 5 5 5 5 ")
 !(" 454 54444 5 5 5 5 ")
 !(" 454 55554 5 5 5 5 ")
 !(" 454 44445 5 5 5 5 ")
 !(" 454 44435 5 5 5 5 ")
 !(" 454 54445 5 5 5 5 ")
 !(" 555 45554 454 454 ")
 !("         2         ")
;6
 !("73   3   3   3   3 ")
 !(" 55445544544554455 ")
 !("         5        2")
 !(" 55445544544554455 ")
 !("     55     55     ")
 !(" 55445544544554455 ")
 !(" 55             552")
 !(" 55445544544554455 ")
 !("         5         ")
 !("4554455445445544554")
;7
 !("7                  ")
 !("                   ")
 !("    44444444444    ")
 !("    44343434344    ")
 !("    44444444444    ")
 !("    43434343434    ")
 !("    44444444444    ")
 !("    44444444444    ")
 !("                   ")
 !("1                 1")
;8
 !("7                  ")
 !("  3   3     3   3  ")
 !("  444444444444444  ")
 !("  4442       2444  ")
 !("  55455 555 55455  ")
 !("  54555 555 55545  ")
 !("  4442       2444  ")
 !("  444444444444444  ")
 !("                   ")
 !("                   ")
;9
 !("7       3 3        ")
 !(" 55 55 55 55 55 55 ")
 !("     3       3     ")
 !(" 55 55 55 55 55 55 ")
 !(" 3               3 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !(" 3 3 3 3 3 3 3 3 3 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !("1122           2211")
 !("4545454545454545454")
;10
 !("75               5 ")
 !("   3    3 3    3   ")
 !("5554 55 555 55 4555")
 !("                   ")
 !(" 55555555 55555555 ")
 !("     3       3     ")
 !("   5 555555555 5   ")
 !("  5             5  ")
 !("45               54")
 !("54      121      45")
;11
 !("7   3         3    ")
 !("5 555 5555555 555 5")
 !("4 3             3 4")
 !("5 55555 555 55555 5")
 !("4   3         3   4")
 !("5 5 5555 5 5555 5 5")
 !("4                 4")
 !("5 555 555 555 555 5")
 !("4             11224")
 !("5454545454545454545")
;12
 !("75   5   5   5   5 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !(" 3 5 3 5 3 5 3 5 3 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !(" 5   5   5   5   5 ")
 !(" 5 3 5 3 5 3 5 3 5 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !("   5   5   5   5   ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !(" 5  452 452 452 452")
;13
 !("7                  ")
 !("                   ")
 !("                   ")
 !("   3 3 3   3 3 3   ")
 !("   55555   55555   ")
 !("44               44")
 !(" 4               4 ")
 !(" 4               4 ")
 !(" 4   444444444   4 ")
 !("24   4   2   4   42")
;14
 !("7555555555555555555")
 !(" 5 4 5 4 5 4 4543 5")
 !("454545454545455 515")
 !(" 5 5 5 5 5 5 5 4525")
 !("4545454545454545515")
 !(" 5 5 5 5 5 5 5 4525")
 !("454545454545455 515")
 !(" 5 5 5 5 5 5 5 4525")
 !("4 454 454 454 45514")
 !("5555555555555555525")
;15
 !("7               3  ")
 !("              3 45 ")
 !("            3 45   ")
 !("          3 45     ")
 !("        3 45       ")
 !("      3 45         ")
 !("    3 45           ")
 !("  3 45            1")
 !("  45             12")
 !("45              124")
;16
 !("7                  ")
 !("                   ")
 !(" 3               3 ")
 !(" 55555555555555555 ")
 !(" 3               5 ")
 !(" 3           4   5 ")
 !(" 44444444444444445 ")
 !(" 55555555555555555 ")
 !("                   ")
 !("        111        ")
;17
 !("73                 ")
 !(" 43                ")
 !(" 443               ")
 !(" 4443              ")
 !(" 44443             ")
 !(" 444443            ")
 !(" 4444443           ")
 !(" 44444443          ")
 !(" 444444443        2")
 !(" 44444444434     22")
;18
 !("7          5     54")
 !(" 555555555 5 5 5   ")
 !("        5    5 5 55")
 !(" 555545 5 5555 5  5")
 !("    554 5   54 55 4")
 !("555   55455  545  5")
 !("45  5  5   5  54 54")
 !(" 54545   5  5  5   ")
 !("  55   5555  1 555 ")
 !("5    5    4545  454")
;19
 !("73 55555 4         ")
 !(" 3    25 5 555 555 ")
 !(" 3   225 5   3 3   ")
 !(" 3 55515 5 5 555 5 ")
 !(" 3 55515 5         ")
 !(" 5 34415 5  55555  ")
 !(" 5444415 5         ")
 !(" 5555555 5 5 555 5 ")
 !(" 5   5   5    2    ")
 !("   5   5 5454545454")
;20
 !("75   5   5   5   51")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !("   5   5 5 5   5   ")
 !("55555555 5 55555555")
 !("      3    54444444")
 !("      3 55544545454")
 !("  44444 5          ")
 !(" 55555554 55555555 ")
 !("                   ")
;21
 !("7  3     3     3   ")
 !(" 454 454 5 454 454 ")
 !(" 545 545 5 545 545 ")
 !("     3       3     ")
 !("  5  5  5 5  5  5  ")
 !("         2         ")
 !(" 5  5  5 5 5  5  5 ")
 !("                   ")
 !("4444444444444444444")
 !("5551555552555551555")
;22
 !("7        3         ")
 !("   454  454  454   ")
 !(" 3 515  525  515 3 ")
 !(" 3 444  444  444 3 ")
 !(" 55555555555555555 ")
 !("    3         3    ")
 !(" 55 55 5 5 5 55 55 ")
 !("                   ")
 !("155 555 555 555 551")
 !("54       2       45")
;23
 !("7                  ")
 !("         3         ")
 !("        444        ")
 !("        414        ")
 !("        444        ")
 !("        424        ")
 !("        444        ")
 !("        414        ")
 !("4444444444444444444")
 !("5555555552555555555")
;24
 !("7                  ")
 !("                   ")
 !("     434444434     ")
 !("     444414444     ")
 !("     444343444     ")
 !("     424444424     ")
 !("     444414444     ")
 !("     444444444     ")
 !("         1         ")
 !("         1         ")
;25
 !("7                  ")
 !("                   ")
 !("                   ")
 !(" 3   3   3   3   3 ")
 !(" 5 5 5 5 5 5 5 5 5 ")
 !("                   ")
 !("                   ")
 !("1                  ")
 !("4444444444444444444")
 !("5555125521255215555")
;26
 !("7                  ")
 !("                   ")
 !("       34443       ")
 !("       45154       ")
 !("       44444       ")
 !("       45254       ")
 !("       44444       ")
 !("       45154       ")
 !("       44444       ")
 !("5555555552555555555")
;27
 !("73                 ")
 !("545                ")
 !("                   ")
 !("                  1")
 !("                  1")
 !("                  1")
 !("                  1")
 !("        3      3   ")
 !("  5 5   44444444   ")
 !("  54555552255225555")
;28
 !("7                  ")
 !(" 535               ")
 !(" 535               ")
 !(" 535               ")
 !(" 535               ")
 !(" 535               ")
 !("  3                ")
 !(" 545               ")
 !("4444444444444444444")
 !("5555552515251525155")
;29
 !("75               3 ")
 !(" 5  4            3 ")
 !(" 54444444444444444 ")
 !(" 54145555555555555 ")
 !(" 54445   5   55445 ")
 !(" 5     5   5   445 ")
 !(" 55555555555555555 ")
 !(" 3                 ")
 !(" 3            4 444")
 !(" 444444444444444414")
;30
 !("7                  ")
 !(" 3                 ")
 !(" 3                 ")
 !(" 3                 ")
 !(" 3                 ")
 !(" 3                 ")
 !(" 3                 ")
 !(" 3                 ")
 !(" 344444444444444444")
 !(" 441424142424142414")
